---
theme: geist
colorSchema: light

layout: center

drawings:
  persist: false

# slide transition: https://sli.dev/guide/animations.html#slide-transitions
transition: slide-left

# enable MDC Syntax: https://sli.dev/features/mdc
mdc: true
---

# RubyKaigi 2025 äºˆç¿’Bootcamp

2025/03/07 MSèŠæµ¦ãƒ“ãƒ«

---
layout: center
---

# ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ï¼ï¼



---
layout: center
---

# ä»Šæ—¥ã¯Rubyã«ã¤ã„ã¦ã¨ã“ã¨ã‚“å­¦ã‚“ã§ã‚‚ã‚‰ã„ã¾ã™

---
layout: center
---

# ãªãœã‹

---
title: rubykaigi ogp
layout: image
image: rubykaigi-ogp.jpg
---


---
layout: center
---

# Ruby ã®ã“ã¨ã‚’çŸ¥ã‚‰ãªã„ã¨ã€<br/>RubyKaigiã¯æ¥½ã—ã‚ãªã„

---
layout: center
---

<div class='flex justify-center' >
  <img src='./public/ruby-intro.png' class='w-3/4'/>
</div>


---
layout: center
---

# RubyKaigiã‚’å…¨åŠ›ã§æ¥½ã—ã¿ãƒ»å®Ÿã‚Šã‚ã‚‹ä¼šã«ã™ã‚‹

<p class='text-2xl'>ãã—ã¦ã€ãã®ãŸã‚ã«ã¯çš†ã•ã‚“ãŒä¸»ä½“çš„ã«å–ã‚Šçµ„ã‚€å¿…è¦ãŒã‚ã‚Šã¾ã™</p>

---
layout: center
---

# ç†±ãã¦ãƒ¯ã‚¯ãƒ¯ã‚¯ã™ã‚‹ã‚ˆã†ãª1æ—¥ã«ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼ï¼ğŸ’ª


---
layout: default
---

# ä»Šæ—¥ã®ãŠå“æ›¸ã
<v-click>
  <h2> åˆå‰ã®éƒ¨ </h2>
  <p class="text-2xl text-black">Rubyã®è¨€èªå‡¦ç†ç³»ã«ã¤ã„ã¦<strong>å…¨ä½“åƒ</strong>ã‚’æŠŠæ¡ã—ã¦ã‚‚ã‚‰ã„ã¾ã™</p>
  <v-click>
    <ul class="text-xl">
      <li>ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªå‡¦ç†ç³»ã®å‰æçŸ¥è­˜</li>
      <li>Rubyã®è¨€èªå‡¦ç†ç³»ã«ãŠã‘ã‚‹ã‚¹ãƒ†ãƒƒãƒ—ã®å…¨ä½“åƒ</li>
    </ul>
  </v-click>
</v-click>

<v-click>
  <h2> åˆå¾Œã®éƒ¨ </h2>
  <p class="text-2xl text-black"><strong>ã‚ˆã‚Šå„è«–çš„ãªå†…å®¹ã«DeepDive</strong>ã—ã¦ã„ãã¾ã™</p>
  <v-click>
    <ul class="text-xl">
      <li>Parserå‘¨ã‚Š: Prism, Lrama...</li>
      <li>ä¸¦è¡Œãƒ»ä¸¦åˆ—å‡¦ç†: ã‚¹ãƒ¬ãƒƒãƒ‰/ãƒ—ãƒ­ã‚»ã‚¹, æ’ä»–å‡¦ç†, ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•, Fiber, Ractor...</li>
      <li>JITã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã®å‹•å‘: RJIT, YJIT, LBBV, ...</li>
    </ul>
  </v-click>
</v-click>

---
layout: center
---

# ã•ã¦ã•ã¦ã€


---
layout: center
---

# ruby -e "puts 7 + 8"
<p class="text-xl">ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’é©å½“ãªã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã‹ã‚‰å®Ÿè¡Œã™ã‚‹ã¨...</p>


---
layout: center
---

# 15 <span class="text-xl">ã§ã™ã‚ˆã­</span>


---
layout: center
---

<h1 class="font-bold text-2xl text-black"> ã§ã‚‚ã€<strong class="text-4xl text-black">ãªãœï¼Ÿ</strong></h1>


---
layout: cover
---

<div class='flex flex-row gap-4 justify-center'>
  <div class='flex flex-col items-center'>
    <img src='./public/NikoTinbergen.jpg' class='w-3/5'/>
    <a class='text-sm' href='https://ja.wikipedia.org/wiki/%E3%83%8B%E3%82%B3%E3%83%BB%E3%83%86%E3%82%A3%E3%83%B3%E3%83%90%E3%83%BC%E3%82%B2%E3%83%B3' target='_blank'>
      <span class='italic'>Nikolaas Tinbergen</span><br>ã‚ªãƒ©ãƒ³ãƒ€ã®å‹•ç‰©è¡Œå‹•å­¦è€…ãƒ»é³¥é¡å­¦è€…
    </a>
  </div>
  <h2 class='m-auto mx-0'> 
    ãªãœï¼Ÿ<span class="text-xl">ã‚’è€ƒãˆã‚‹ä¸Šã§ã¯ã€</span><br/>
    ãƒ†ã‚£ãƒ³ãƒãƒ¼ã‚²ãƒ³ã®4ã¤ã®å•ã„<span class="text-xl">ã§æ•´ç†ã§ãã‚‹</span>
  </h2>
</div>

---
layout: default
---

# ãƒ†ã‚£ãƒ³ãƒãƒ¼ã‚²ãƒ³ã®4ã¤ã®å•ã„

||<span class="font-bold">è‡³è¿‘è¦å› </span>|<span class="font-bold">ç©¶æ¥µè¦å› </span>|
|-|---|----|
|é™çš„|<span class="font-bold">ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¨ã—ã¦ã®ãªãœ</span>|<span class="font-bold">é©å¿œã¨ã—ã¦ã®ãªãœ</span>|
|å‹•çš„|<span class="font-bold">ç™ºç”Ÿ</span>|<span class="font-bold">é€²åŒ–</span>|

<a class='inline-block italic text-right' href='https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1439-0310.1963.tb01161.x' target='_blank'>
  Tinbergen, N. (1963). On aims and methods of ethology.
</a>

---
layout: default
---

<div class="flex flex-row">
  <h1>ä¾‹:ã‚·ã‚¸ãƒ¥ã‚¦ã‚«ãƒ©ã¯æ˜¥ã«ãªãœé³´ãã®ã‹ï¼Ÿ</h1>
  <img src='/public/sijukara.jpeg' class='w-1/5 pt-4'/>
</div>

||<span class="font-bold">è‡³è¿‘è¦å› </span>|<span class="font-bold">ç©¶æ¥µè¦å› </span>|
|-|---|----|
|é™çš„|<span class="font-bold">ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¨ã—ã¦ã®ãªãœ:</span><br/><span class="text-xl">å­£ç¯€ã®å¤‰åŒ–ã‚’ã©ã®ã‚ˆã†ã«ã—ã¦çŸ¥ã‚‹ã®ã‹ï¼Ÿã©ã®ã‚ˆã†ãªãƒ›ãƒ«ãƒ¢ãƒ³ãŒæ­Œç”Ÿæˆã‚’ä¿ƒã™ã®ã‹ï¼Ÿ</span>|<span class="font-bold">é©å¿œã¨ã—ã¦ã®ãªãœ</span>:<br/><span class="text-xl">æ­Œã¯ã€ãªã‚ã°ã‚Šã®ç¶­æŒã‚„é…å¶ç²å¾—ã¨ã„ã†ç‚¹ã§ã€ç¹æ®–æˆåŠŸç‡ã‚’ã©ã®ç¨‹åº¦ä¸Šæ˜‡ã•ã›ã‚‹ã‹ï¼Ÿ</span>|
|å‹•çš„|<span class="font-bold">ç™ºç”Ÿ:</span><br/><span class="text-xl"> ãƒ’ãƒŠã‹ã‚‰æˆé•·ã—ã¦ãã‚‹é–“ã«ã€é³´ãå£°ã¯ã©ã®ã‚ˆã†ã«ã—ã¦æ­Œã«å¤‰ã‚ã‚‹ã®ã‹ï¼Ÿ</span>|<span class="font-bold">é€²åŒ–:</span><br/><span class="text-xl"> ç¥–å…ˆã®é³¥ã‹ã‚‰ã®ç³»çµ±ã«ãŠã„ã¦ã€æ­Œã®èƒ½åŠ›ã‚„ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ã©ã®ã‚ˆã†ã«å¤‰åŒ–ã—ãŸã®ã‹ï¼Ÿ</span>|


---
layout: center
---

<h1 class='!mb-6'>
  <span class="text-xl">ä»Šæ—¥ã®Bootcampã§ã¯</span>
  <br>
  <span v-mark.underline.red>
  Rubyã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¨ã—ã¦ã®ãªãœ
  </span>
  <span class="text-xl">ã‚’çªãè©°ã‚ã¦ã„ãã¾ã™</span>
</h1>

<v-click>
  <p class="text-2xl text-black">ãã—ã¦ãã®éç¨‹ã§Rubyã¨ã„ã†ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãŒ<br/>ã©ã®ã‚ˆã†ã«ç™ºé”/é€²åŒ–(<strong>Develop</strong>)ã—ã¦ããŸã®ã‹ã®ä¸€ç«¯ã‚’å£é–“è¦‹ã¦ã»ã—ã„ã§ã™</p>
</v-click>



---
layout: center
---

# ã€Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œã™ã‚‹ã€ã¨ã„ã†ã“ã¨ã«ã¤ã„ã¦è€ƒãˆã¦ã¿ã¾ã™

---
layout: default
---

<h1>ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯å‡¦ç†ç³»ãŒå¿…è¦ã§ã™ã­</h1>
<div class='flex'>
  <div class='basis-1/2'>
    <p class='text-2xl'>å¤§å‰æï¼š<strong>è¨€èªä»•æ§˜ã¨å‡¦ç†ç³»ã¯åˆ¥ç‰©</strong> </p>
    <p class='text-xl'>åŒã˜Rubyã®ã‚½ãƒ¼ã‚¹ãŒå‹•ã‹ã›ã‚‹ã‹ã‚‰ã¨ã„ã£ã¦ã€ä»–ã®ç’°å¢ƒã¨ã®å‡¦ç†ç³»ãŒåŒã˜ã§ã‚ã‚‹ä¿è¨¼ã¯ãªã„</p>
  </div>
  <div class='basis-1/2'>
    <img src='./public/ruby-intro.png' class='w-full'/>
  </div>
</div>



---
layout: default
---

# Rubyã®è¨€èªå‡¦ç†ç³»ã«ã¤ã„ã¦
<h2> <span  v-mark.circle.orange>CRuby (MRI)</span></h2>
<p class='text-xl'>
  MatzãŒä½œã£ãŸRuby, <strong>MRI (Matz' Ruby Implementation)</strong>
</p>
<p>
  MRIãŒå®Ÿè³ªçš„ã«Rubyã®è¨€èªä»•æ§˜ã«ãªã£ã¦ã„ã‚‹<br><strong>->MRIã§å–ã‚Šè¾¼ã¾ã‚ŒãŸæ©Ÿèƒ½ãŒRubyã®è¨€èªä»•æ§˜ã¨ã—ã¦æ¡ç”¨ã•ã‚Œã‚‹</strong>
</p>


## JRuby
<p class='text-xl'>
Javaè¨€èªã§å®Ÿè£…ã•ã‚ŒãŸRubyã®å‡¦ç†ç³»ã€‚
Rubyã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã‚ã‚‹JVMï¼ˆJava Virtual Machineï¼‰ä¸Šã§å®Ÿè¡Œã§ãã€Rubyã§å®Ÿè£…ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ä¸Šã§Javaã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒåˆ©ç”¨å¯èƒ½ã§ã‚ã‚‹ã€‚ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ãƒ»å®Ÿè¡Œæ™‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ»äº‹å‰ã‚³ãƒ³ãƒ‘ã‚¤ãƒ© ã®3ç¨®é¡ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã€‚
</p>

[ä»–ã«ã‚‚ãŸãã•ã‚“](https://www.ruby.or.jp/ja/tech/install/ruby/implementations)


---
layout: default
---
# ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿å‹è¨€èªã®åŸºæœ¬

<p class='text-xl'>
ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã§é€æ¬¡çš„ã«ã‚½ãƒ¼ã‚¹ã‚’è§£é‡ˆã—ã¦å®Ÿè¡Œã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿è¨€èªã§ã¯ã€<br/>åŸºæœ¬çš„ã«ã¯ä¸‹è¨˜ã®ã‚ˆã†ãªæµã‚Œã‚’ã¨ã‚Šã¾ã™
</p>
<div class='w-full flex justify-center mt-16'>
```mermaid {scale: 1.0}
graph LR
    A[ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰] -->|å­—å¥è§£æ| B[ãƒˆãƒ¼ã‚¯ãƒ³åˆ—]
    B -->|æ§‹æ–‡è§£æ| C[æ§‹æ–‡æœ¨ï¼ˆASTï¼‰]
    C -->|å®Ÿè¡Œ| D[å®Ÿè¡Œçµæœ]
```
</div>

<v-click>
<p class='text-2xl text-center'>
æ„å¤–ã¨ã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã­<br/><span class='font-bold'>ã“ã®æµã‚ŒãŒåŸºæœ¬ä¸­ã®åŸºæœ¬ãªã®ã§è¦šãˆã¾ã—ã‚‡ã†ï¼</span>
</p>
</v-click>


---
layout: default
---
# å‚è€ƒï¼‰ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å‹è¨€èªã ã¨ï¼Ÿ

<p class='text-xl'>
äº‹å‰ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã‚‹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å‹è¨€èªï¼ˆAOTã€Ahead of Timeã¨ã‹è¨€ã£ãŸã‚Šã—ã¾ã™ï¼‰ã ã¨<br/>ä¸‹è¨˜ã®ã‚ˆã†ãªä½œã‚Šæ–¹ã‚’ã—ã¾ã™
</p>
<div class='w-full flex justify-center'>
```mermaid {scale: 0.8}
graph LR
  A[ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰<br/>sample.c] -->|ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©| B[ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«<br/>sample.o]
  B -->|ãƒªãƒ³ã‚«| C[å®Ÿè¡Œå¯èƒ½ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ <br/>a.out]
  C -->|ãƒ­ãƒ¼ãƒ‰| D[ãƒ—ãƒ­ã‚»ã‚¹ã¨ã—ã¦å®Ÿè¡Œ]
```
</div>

<p class='text-xl'>
å®Ÿéš›ã®ã¨ã“ã‚ã€è¿‘å¹´ã ã¨<a href='https://llvm.org/' target='_blank'>LLVM</a>ã¨å‘¼ã°ã‚Œã‚‹åŸºç›¤ã®ä¸Šã§ã€ä¸­é–“è¡¨ç¾ã‚’æŒŸã¿ãªãŒã‚‰æœ€é©åŒ–ã«æœ€é©åŒ–ã‚’é‡ã­ã¦ã„ã‚‹ã®ã§ã‚‚ã£ã¨è¤‡é›‘ã§ã™ã€‚
ä½œã‚‹å´ã¯LLVMã«åˆã‚ã›ã¦ä¸­é–“è¡¨ç¾ã‚’åãå‡ºã›ã°ã„ã„ã®ã§ã€<strong>ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œã—ã‚„ã™ã„</strong>ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚Šã¾ã™
</p>
<div class='w-full flex justify-center'>
  <img src='./public/LLVM.png' class='w-3/5'/>
</div>


---
layout: default
---
# CRubyãŒå®Ÿè¡Œã•ã‚Œã‚‹ã¾ã§ã®ã‚¹ãƒ†ãƒƒãƒ—

<p class='text-xl'>
<span>Ruby1.8ã¾ã§:</span> åŸºæœ¬ã¯ã•ã£ãã®å†…å®¹ã¨<strong>åŒã˜</strong>
</p>
<div class='w-full flex justify-center mt-16'>
```mermaid {scale: 0.9}
graph LR
    A[ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰] -->|å­—å¥è§£æ| B[ãƒˆãƒ¼ã‚¯ãƒ³åˆ—]
    B -->|æ§‹æ–‡è§£æ| C[æ§‹æ–‡æœ¨ï¼ˆASTï¼‰]
    C -->|è§£é‡ˆãƒ»å®Ÿè¡Œ| D[å®Ÿè¡Œçµæœ]
```
</div>

<v-click>
  <p class='text-2xl text-center font-bold'>
  ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’é †ã«è¿½ã£ã¦ã¿ã¦ã„ãã¾ã—ã‚‡ã†
  </p>
</v-click>


---
layout: default
---
# å­—å¥è§£æ

<p class='text-xl'>
  ã‚½ãƒ¼ã‚¹ã‚’ãƒˆãƒ¼ã‚¯ãƒ³ã¨ã—ã¦åˆ†è§£ã™ã‚‹
</p>

``` rb
require 'ripper'

example = <<~EXAMPLE
  def foo(a,b)
    puts a + b
  end
  foo(9,8)
EXAMPLE

pp Ripper.lex(example)
```
<v-click>
  <p class='text-2xl text-center font-bold'>æ‰‹å…ƒã§å©ã„ã¦ã¿ã‚ˆã†â†‘</p>
</v-click>


---
layout: default
---

<p class='text-xl'>
  [line number, column number], token type, lexeme, tokenã‚’èª­ã¿å–ã£ãŸæ™‚ã®çŠ¶æ…‹
</p>

```rb {*}{maxHeight: '400px', class:'!children:text-xs'}
[[[1, 0], :on_kw, "def", FNAME],
 [[1, 3], :on_sp, " ", FNAME],
 [[1, 4], :on_ident, "foo", ENDFN],
 [[1, 7], :on_lparen, "(", BEG|LABEL],
 [[1, 8], :on_ident, "a", ARG],
 [[1, 9], :on_comma, ",", BEG|LABEL],
 [[1, 10], :on_ident, "b", ARG],
 [[1, 11], :on_rparen, ")", ENDFN],
 [[1, 12], :on_ignored_nl, "\n", BEG],
 [[2, 0], :on_sp, "  ", BEG],
 [[2, 2], :on_ident, "puts", CMDARG],
 [[2, 6], :on_sp, " ", CMDARG],
 [[2, 7], :on_ident, "a", END|LABEL],
 [[2, 8], :on_sp, " ", END|LABEL],
 [[2, 9], :on_op, "+", BEG],
 [[2, 10], :on_sp, " ", BEG],
 [[2, 11], :on_ident, "b", END|LABEL],
 [[2, 12], :on_nl, "\n", BEG],
 [[3, 0], :on_kw, "end", END],
 [[3, 3], :on_nl, "\n", BEG],
 [[4, 0], :on_ident, "foo", CMDARG],
 [[4, 3], :on_lparen, "(", BEG|LABEL],
 [[4, 4], :on_int, "9", END],
 [[4, 5], :on_comma, ",", BEG|LABEL],
 [[4, 6], :on_int, "8", END],
 [[4, 7], :on_rparen, ")", ENDFN],
 [[4, 8], :on_nl, "\n", BEG]]
```

---
layout: default
---
# CRubyãŒå®Ÿè¡Œã•ã‚Œã‚‹ã¾ã§ã®ã‚¹ãƒ†ãƒƒãƒ—

<div class='w-full flex justify-center mt-16'>
```mermaid {scale: 0.9}
graph LR
    A[ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰] -->|å­—å¥è§£æ| B[ãƒˆãƒ¼ã‚¯ãƒ³åˆ—]
    B -->|æ§‹æ–‡è§£æ| C[æ§‹æ–‡æœ¨ï¼ˆASTï¼‰]
    C -->|è§£é‡ˆãƒ»å®Ÿè¡Œ| D[å®Ÿè¡Œçµæœ]
    classDef finishStyle fill:#ffcc00,stroke:#333,stroke-width:2px;
    class A finishStyle
    class B finishStyle
```
</div>

<v-click>
  <p class='text-2xl text-center font-bold'>
  ãƒˆãƒ¼ã‚¯ãƒ³åˆ—ãŒã§ããŸ
  </p>
</v-click>

---
layout: default
---
# æ§‹æ–‡è§£æ

<p class='text-xl'>
  åˆ†è§£ã—ãŸãƒˆãƒ¼ã‚¯ãƒ³ã«æ„å‘³ã‚’ä¸ãˆã€æŠ½è±¡æ§‹æ–‡æœ¨ï¼ˆAbstract Syntax Tree, ASTï¼‰ã‚’ä½œã‚‹
</p>

``` rb
require 'ripper'

example = <<~EXAMPLE
  def foo(a,b)
    puts a + b
  end
  foo(9,8)
EXAMPLE

pp Ripper.sexp(example)
```

<v-click>
  <p class='text-2xl text-center font-bold'>æ‰‹å…ƒã§å©ã„ã¦ã¿ã‚ˆã†â†‘</p>
</v-click>

---
layout: default
---

<p class='text-xl'>
  ä¸‹è¨˜ã®ã‚ˆã†ãªæ„å‘³ã‚’æŒã¤<br>
  [line number, column number], token type, lexeme, tokenã‚’èª­ã¿å–ã£ãŸæ™‚ã®çŠ¶æ…‹
</p>

```rb {*}{maxHeight: '400px', class:'!children:text-xs'}
[:program,
 [[:def,
   [:@ident, "foo", [1, 4]],
   [:paren,
    [:params,
     [[:@ident, "a", [1, 8]], [:@ident, "b", [1, 10]]],
     nil,nil,nil,nil,nil,nil]],
   [:bodystmt,
    [[:command,
      [:@ident, "puts", [2, 2]],
      [:args_add_block,
       [[:binary,
         [:var_ref, [:@ident, "a", [2, 7]]],
         :+,
         [:var_ref, [:@ident, "b", [2, 11]]]]],
       false]]],nil,nil,nil]],
  [:method_add_arg,
   [:fcall, [:@ident, "foo", [4, 0]]],
   [:arg_paren,
    [:args_add_block, [[:@int, "9", [4, 4]], [:@int, "8", [4, 6]]], false]]]]]
```


---
layout: default
---
# CRubyãŒå®Ÿè¡Œã•ã‚Œã‚‹ã¾ã§ã®ã‚¹ãƒ†ãƒƒãƒ—

<div class='w-full flex justify-center mt-16'>
```mermaid {scale: 0.9}
graph LR
    A[ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰] -->|å­—å¥è§£æ| B[ãƒˆãƒ¼ã‚¯ãƒ³åˆ—]
    B -->|æ§‹æ–‡è§£æ| C[æ§‹æ–‡æœ¨ï¼ˆASTï¼‰]
    C -->|è§£é‡ˆãƒ»å®Ÿè¡Œ| D[å®Ÿè¡Œçµæœ]
    classDef finishStyle fill:#ffcc00,stroke:#333,stroke-width:2px;
    class A finishStyle
    class B finishStyle
    class C finishStyle
```
</div>

<v-click>
  <p class='text-2xl text-center font-bold'>
  ASTãŒã§ããŸ
  </p>
</v-click>


---
layout: center
---
# å­—å¥è§£æãƒ»æ§‹æ–‡è§£æã®ç¶šãã¯åˆå¾Œã®éƒ¨ã§æ¾èˆ˜ã‹ã‚‰



---
layout: default
---
# è§£é‡ˆãƒ»å®Ÿè¡Œ

Tree-Walkingã§å®Ÿè¡Œã™ã‚‹<br/>
ã²ãŸã™ã‚‰é•·ã„caseæ–‡ãŒã‚ã£ã¦ã€å†å¸°çš„ã«`eval`ã‚’å©ã„ã¦ã„ã

``` rb
# å‡¦ç†ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ãªã®ã§å®Ÿéš›ã«ã¯å‹•ã‹ãªã„
def eval(node)
  case node[:type]  # ãƒãƒ¼ãƒ‰ã®ç¨®é¡ã§åˆ†å²
  when 'integer'# æ•°å€¤ãƒªãƒ†ãƒ©ãƒ«
    node[:value]  
  when 'true', 'false' # çœŸå½å€¤
    # ...
  when 'array' # é…åˆ—
    node[:entries].map { |entry| eval(entry) }  # å„è¦ç´ ã‚’å†å¸°çš„ã«è©•ä¾¡
  when 'prefix-expr' # å‰ç½®æ¼”ç®—å­ã®å‡¦ç†ã‚’ã™ã‚‹
    left = eval(node[:left])
    right = eval(node[:right])
    # ...
  when 'infix-expr' # å‰ç½®æ¼”ç®—å­ã®å‡¦ç†ã‚’ã™ã‚‹
    right = eval(node[:right])
    # ...
  end
end
```


---
layout: default
---
# CRubyãŒå®Ÿè¡Œã•ã‚Œã‚‹ã¾ã§ã®ã‚¹ãƒ†ãƒƒãƒ—

<!-- VMã®ç´¹ä»‹ -->

<p class='text-xl'>
<span>Ruby1.8ã¾ã§:</span>
</p>
<div class='w-full flex justify-center mt-16'>
```mermaid {scale: 0.9}
graph LR
    A[ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰] -->|å­—å¥è§£æ| B[ãƒˆãƒ¼ã‚¯ãƒ³åˆ—]
    B -->|æ§‹æ–‡è§£æ| C[æ§‹æ–‡æœ¨ï¼ˆASTï¼‰]
    C -->|è§£é‡ˆãƒ»å®Ÿè¡Œ| D[å®Ÿè¡Œçµæœ]
    classDef finishStyle fill:#ffcc00,stroke:#333,stroke-width:2px;
    class A finishStyle
    class B finishStyle
    class C finishStyle
    class D finishStyle
```
</div>

<v-click>
<p class='text-xl'>
  <strong>Ruby 1.9</strong>ã‹ã‚‰: é«˜é€ŸåŒ–ã‚’ç›®çš„ã¨ã—ã¦VMãŒè¿½åŠ ã•ã‚ŒãŸ
  <span class='text-sm'>(2007-12-25ãƒªãƒªãƒ¼ã‚¹)</span>
</p>
<div class='w-full flex justify-center mt-16'>
```mermaid {scale: 0.7}
graph LR
    A[ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰] -->|å­—å¥è§£æ| B[ãƒˆãƒ¼ã‚¯ãƒ³åˆ—]
    B -->|æ§‹æ–‡è§£æ| C[æ§‹æ–‡æœ¨ï¼ˆASTï¼‰]
    C -->|ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«| D[ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰]
    D -->|å®Ÿè¡Œ| E[VMãŒå®Ÿè¡Œ]
    classDef newVMStyle fill:#a0e57b,stroke:#333,stroke-width:2px;
    class D newVMStyle
    class E newVMStyle    
```
</div>
</v-click>

<v-click>
  <p class='text-2xl text-center'>
    ã“ã®VMã®ã“ã¨ã‚’
    <strong>
      YARV(Yet Another Ruby VM)
    </strong>
    ã¨å‘¼ã³ã¾ã™
  </p>
</v-click>


---
layout: default
---
# VM
## VMã¨ã¯
<p class='text-xl'>è¨ˆç®—è³‡æºã®ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã€‚ãƒã‚·ãƒ³ã‚’æ¨¡å€£ã—ãŸä»®æƒ³ãªãƒã‚·ãƒ³(Virtual Machine)</p>

## VMã®ãƒ¡ãƒªãƒƒãƒˆ
- <p class='text-xl'>PortabilityãŒé«˜ã„</p>
- <p class='text-xl'>æœ€é©åŒ–ãŒã‹ã‘ã‚„ã™ã„</p>

## VMã®ä¾‹
- <p class='text-xl'>Java, .NET, Lua, JavaScript(V8)</p>
and more...

---
layout: default
---
# Portability

<div class="flex flex-col">
  <div class="flex justify-center">
``` 
+-----------+  +-----------+  +-----------+
| è¨€èª P1   |  | è¨€èª P2   |  | è¨€èª P3   |
|           |  |           |  |           |
+-----------+  +-----------+  +-----------+
| ç’°å¢ƒ E1   |  | ç’°å¢ƒ E2   |  | ç’°å¢ƒ E3   |
+-----------+  +-----------+  +-----------+
                    â†“
+-----------------------------------------+
|             ãƒ—ãƒ­ã‚°ãƒ©ãƒ è¨€èª P            |
+-----------+--+-----------+--+-----------+
| ä¸­é–“å±¤ I1 |  | ä¸­é–“å±¤ I2 |  | ä¸­é–“å±¤ I3 |
+-----------+  +-----------+  +-----------+
| ç’°å¢ƒ E1   |  | ç’°å¢ƒ E2   |  | ç’°å¢ƒ E3   |
+-----------+  +-----------+  +-----------+
```


  </div>
  <div class='p-4 text-xl flex justify-center flex-col gap-2'>
    <p class='!m-0'>ç’°å¢ƒå˜ä½ã§nå€‹ã®å‡¦ç†ç³»ã‚’ä½œã‚‹ã®ã§ã¯ãªãã€ä¸­é–“è¨€èªã§è¨˜è¿°ã•ã‚ŒãŸå‡¦ç†ç³»ã‚’1ã¤è¨­ã‘ã‚‹ã€‚</p>
    <p class='!m-0'>Pã®å‡¦ç†ç³»ã‚’ã¾ã‚‹ã”ã¨ä½œã‚‹ã®ã¯å¤§å¤‰ã ã‘ã©ã€<br><strong>ä¸­é–“å±¤ã§ã‚ã‚‹Iã®å‡¦ç†ç³»ã‚’ç’°å¢ƒã”ã¨ã«ä½œã‚‹ã®ã¯ãã“ã¾ã§å¤§å¤‰ã§ã¯ãªã„</strong>ã¨ã„ã†ç™ºæƒ³</p>
    <a href='https://magazine.rubyist.net/articles/0007/0007-YarvManiacs.html#fn:1' target='_blank'>ref</a>
  </div>
</div>



---
layout: default
---
# Portability

<div class="flex flex-col">
  <div class="flex justify-center">
``` 
+-----------------------------------------+
|              Ruby ãƒ—ãƒ­ã‚°ãƒ©ãƒ             |
+-----------+--+-----------+--+-----------+
|Ruby å‡¦ç†ç³»|  |Ruby å‡¦ç†ç³»|  |Ruby å‡¦ç†ç³»|
+-----------+  +-----------+  +-----------+
|    C å±¤   |  |    C å±¤   |  |    C å±¤   |
+-----------+  +-----------+  +-----------+
|   Linux   |  |  Mac      |  |  Windows  |
+-----------+  +-----------+  +-----------+
```
  </div>
  <div class='p-4 text-xl text-center'>
    Cã§ä¸­é–“è¨€èªã‚’å‡¦ç†ã™ã‚‹ç’°å¢ƒã•ãˆã‚ã‚Œã°ã€<br>Rubyã‚’å‹•ã‹ã™ã“ã¨ãŒã§ãã‚‹
  </div>
</div>

<v-click>
  <div class='text-2xl text-center'>
    <strong>ã“ã“ã§ã„ã†ä¸­é–“è¨€èªãŒVMãŒå‡¦ç†ã™ã‚‹ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ã«ãªã‚‹</strong>
    <p class='text-lg'>â€»å„OS/CPUã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«å¯¾å¿œã—ãŸå‡¦ç†ç³»ã‚’ä½œã‚‹ã‚ˆã‚Šã€<br>å…±é€šã®ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ã‚’è§£é‡ˆã™ã‚‹ VM ã‚’ä½œã‚‹æ–¹ãŒç°¡å˜</p>
  </div>
</v-click>

---
layout: default
---

# YARVã®ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰(ISeq)ã‚’ç†è§£ã™ã‚‹
## dumpã—ã¦ã¿ã‚‹
``` rb
example = <<~EXAMPLE
  def foo(a,b)
    puts a + b
  end
  foo(9,8)
EXAMPLE

vm = RubyVM::InstructionSequence
vm.compile_option = false
iseq = vm.compile(example)
puts iseq.disasm

```

<v-click>
  <p class='text-2xl text-center font-bold'>æ‰‹å…ƒã§å©ã„ã¦ã¿ã‚ˆã†â†‘</p>
</v-click>

---
layout: full
---

<div class='flex flex-col justify-center h-full items-center'>
<div class="flex items-center">
<div>
```rb
def foo(a,b)
  ...
end
foo(9,8)
```
</div>
<p class="text-2xl font-bold mx-8">â†’</p>
<div>
``` {*}{maxHeight: '400px', class:'!children:text-xs'}
== disasm: #<ISeq:<compiled>@<compiled>:1 (1,0)-(4,8)>
0000 definemethod                           :foo, foo                 (   1)[Li]
0003 putself                                                          (   4)[Li]
0004 putobject                              9
0006 putobject                              8
0008 send                                   <calldata!mid:foo, argc:2, FCALL|ARGS_SIMPLE>, nil
0011 leave
```
</div>
</div>

<div class="flex items-center">
<div>
```rb
...
puts a + b
...
```
</div>
<p class="text-2xl font-bold mx-8">â†’</p>
<div>
```{*}{maxHeight: '400px', class:'!children:text-xs'}
== disasm: #<ISeq:foo@<compiled>:1 (1,0)-(3,3)>
local table (size: 2, argc: 2 [opts: 0, rest: -1, post: 0, block: -1, kw: -1@-1, kwrest: -1])
[ 2] a@0<Arg>   [ 1] b@1<Arg>
0000 putself                                                          (   2)[LiCa]
0001 getlocal                               a@0, 0
0004 getlocal                               b@1, 0
0007 send                                   <calldata!mid:+, argc:1, ARGS_SIMPLE>, nil
0010 send                                   <calldata!mid:puts, argc:1, FCALL|ARGS_SIMPLE>, nil
0013 leave                                                            (   3)[Re]
```
</div>
</div>
</div>


---
layout: default
---
# CRubyãŒå®Ÿè¡Œã•ã‚Œã‚‹ã¾ã§ã®ã‚¹ãƒ†ãƒƒãƒ—

<div class='w-full flex justify-center mt-16'>
```mermaid {scale: 0.8}
graph LR
    A[ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰] -->|å­—å¥è§£æ| B[ãƒˆãƒ¼ã‚¯ãƒ³åˆ—]
    B -->|æ§‹æ–‡è§£æ| C[æ§‹æ–‡æœ¨ï¼ˆASTï¼‰]
    C -->|ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«| D[ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰]
    D -->|å®Ÿè¡Œ| E[VMãŒå®Ÿè¡Œ]
    classDef finishStyle fill:#ffcc00,stroke:#333,stroke-width:2px;
    class A finishStyle
    class B finishStyle
    class C finishStyle
    class D finishStyle
```
</div>

<v-click>
  <p class='text-2xl text-center font-bold'>
  ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ãŒã§ããŸ
  </p>
</v-click>

---
layout: default
---

<h1>VMã®ç¨®é¡</h1>
<h2><span v-mark.circle.orange>ã‚¹ã‚¿ãƒƒã‚¯ãƒã‚·ãƒ³</span></h2>
<div class='text-xl'>
  <p>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒâ€æ¯”è¼ƒçš„â€æ¥½ã«ä½œã‚Œã‚‹</p>
  <p>ASTã‚’ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã€‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚ŒãŸå‘½ä»¤åˆ—ã‚’é †ç•ªã«ä¸Šã‹ã‚‰å®Ÿè¡Œã—ã¦ã„ã</p>
</div>

<h2>ãƒ¬ã‚¸ã‚¹ã‚¿ãƒã‚·ãƒ³</h2>
<div class='text-xl'>
  <p>å‘½ä»¤ãƒ¬ãƒ™ãƒ«ä¸¦åˆ—åŒ–ãªã©è‰²ã€…æ—©ãã§ãã‚‹ã‚“ã ãŒã€é–‹ç™ºãŒã‚€ãšã„</p>
  <p><a href='https://www.lua.org/doc/jucs05.pdf' target='_blank'>Luaãªã©</a></p>
</div>


<v-after>
  <p class='text-2xl text-center font-bold'>
    YARVã¯2ç¨®é¡ã®ã‚¹ã‚¿ãƒƒã‚¯ã‚’æŒã¤ã‚¹ã‚¿ãƒƒã‚¯ãƒã‚·ãƒ³
  </p>
</v-after>


---
layout: default
---

# YARV
## 2ã¤ã®ã‚¹ã‚¿ãƒƒã‚¯
### 1. <span v-mark.circle.orange>å†…éƒ¨ã‚¹ã‚¿ãƒƒã‚¯</span>
<p class='text-xl'>å€¤ã‚„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¸ã®å‚ç…§ã‚’ä¿æŒã™ã‚‹</p>

### 2. åˆ¶å¾¡ãƒ•ãƒ¬ãƒ¼ãƒ ã‚¹ã‚¿ãƒƒã‚¯
<p class='text-xl'>ãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—/ãƒ–ãƒ­ãƒƒã‚¯ãªã©ã®æƒ…å ±ã‚’ä¿æŒã™ã‚‹</p>





---
layout: default
---
# YARVã‚’ç†è§£ã™ã‚‹

<p class='text-xl'>ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã§ç†è§£ã—ã¦ã¿ã‚‹</p>

```rb
puts 9 + 8
```
<p class='text-xl'>ç”Ÿæˆã•ã‚Œã‚‹ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰</p>
```{*}{maxHeight: '400px'}
0000 putself
0001 putobject(9)
0003 putobject(8)
0005 send(:+, argc:1)
0008 send(:puts, argc:1)
0011 leave
```

---
layout: image
image: vm-simple-stack/simple-stack-1.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/simple-stack-2.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/simple-stack-3.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/simple-stack-4.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/simple-stack-5.png
class: max-w-3xl m-x-auto
transition: none
---


---
layout: image
image: vm-simple-stack/simple-stack-6.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/simple-stack-7.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/simple-stack-8.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/simple-stack-9.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/simple-stack-10.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/simple-stack-11.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: default
---
# YARVã‚’ç†è§£ã™ã‚‹

<p class='text-xl'>ãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—ã®ãƒ‘ã‚¿ãƒ¼ãƒ³</p>

```rb
def foo(a,b)
  puts a + b
end
foo(9,8)
```

---
layout: full
---

<div class='flex flex-col justify-center h-full items-center'>
<div class="flex items-center" v-mark.circle.orange>
<div>
```rb
def foo(a,b)
  ...
end
foo(9,8)
```
</div>
<p class="text-2xl font-bold mx-8">â†’</p>
<div>
``` {*}{maxHeight: '400px', class:'!children:text-xs'}
== disasm: #<ISeq:<compiled>@<compiled>:1 (1,0)-(4,8)>
0000 definemethod                           :foo, foo                 (   1)[Li]
0003 putself                                                          (   4)[Li]
0004 putobject                              9
0006 putobject                              8
0008 send                                   <calldata!mid:foo, argc:2, FCALL|ARGS_SIMPLE>, nil
0011 leave
```
</div>
</div>

<div class="flex items-center">
<div>
```rb
...
puts a + b
...
```
</div>
<p class="text-2xl font-bold mx-8">â†’</p>
<div>
```{*}{maxHeight: '400px', class:'!children:text-xs'}
== disasm: #<ISeq:foo@<compiled>:1 (1,0)-(3,3)>
local table (size: 2, argc: 2 [opts: 0, rest: -1, post: 0, block: -1, kw: -1@-1, kwrest: -1])
[ 2] a@0<Arg>   [ 1] b@1<Arg>
0000 putself                                                          (   2)[LiCa]
0001 getlocal                               a@0, 0
0004 getlocal                               b@1, 0
0007 send                                   <calldata!mid:+, argc:1, ARGS_SIMPLE>, nil
0010 send                                   <calldata!mid:puts, argc:1, FCALL|ARGS_SIMPLE>, nil
0013 leave                                                            (   3)[Re]
```
</div>
</div>
</div>



---
layout: image
image: vm-simple-stack/method-stack-1.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/method-stack-2.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/method-stack-3.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/method-stack-4.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/method-stack-5.png
class: max-w-3xl m-x-auto
transition: none
---





---
layout: full
---

<div class='flex flex-col justify-center h-full items-center'>
<div class="flex items-center">
<div>
```rb
def foo(a,b)
  ...
end
foo(9,8)
```
</div>
<p class="text-2xl font-bold mx-8">â†’</p>
<div>
``` {*}{maxHeight: '400px', class:'!children:text-xs'}
== disasm: #<ISeq:<compiled>@<compiled>:1 (1,0)-(4,8)>
0000 definemethod                           :foo, foo                 (   1)[Li]
0003 putself                                                          (   4)[Li]
0004 putobject                              9
0006 putobject                              8
0008 send                                   <calldata!mid:foo, argc:2, FCALL|ARGS_SIMPLE>, nil
0011 leave
```
</div>
</div>

<div class="flex items-center" v-mark.circle.orange>
<div>
```rb
...
puts a + b
...
```
</div>
<p class="text-2xl font-bold mx-8">â†’</p>
<div>
```{*}{maxHeight: '400px', class:'!children:text-xs'}
== disasm: #<ISeq:foo@<compiled>:1 (1,0)-(3,3)>
local table (size: 2, argc: 2 [opts: 0, rest: -1, post: 0, block: -1, kw: -1@-1, kwrest: -1])
[ 2] a@0<Arg>   [ 1] b@1<Arg>
0000 putself                                                          (   2)[LiCa]
0001 getlocal                               a@0, 0
0004 getlocal                               b@1, 0
0007 send                                   <calldata!mid:+, argc:1, ARGS_SIMPLE>, nil
0010 send                                   <calldata!mid:puts, argc:1, FCALL|ARGS_SIMPLE>, nil
0013 leave                                                            (   3)[Re]
```
</div>
</div>
</div>


---
layout: image
image: vm-simple-stack/method-stack-inscope-1.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/method-stack-inscope-2.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/method-stack-inscope-3.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/method-stack-inscope-4.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/method-stack-inscope-5.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/method-stack-inscope-6.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/method-stack-inscope-7.png
class: max-w-3xl m-x-auto
transition: none
---

---
layout: image
image: vm-simple-stack/method-stack-inscope-8.png
class: max-w-3xl m-x-auto
transition: none
---


---
layout: default
---

<h1>ãªãœVMãªã®ã‹: æœ€é©åŒ–ã®è¦³ç‚¹</h1>
<div>
  <h3>Linear ã§ã‚ã‚‹ã“ã¨ãŒé‡è¦</h3>
  <p>VM ã®ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ã¯ <strong>ç›´ç·šçš„ï¼ˆlinearï¼‰</strong> ã«ä¸¦ã‚“ã§ãŠã‚Šã€ã“ã‚ŒãŒæœ€é©åŒ–ã«ãŠã„ã¦é‡è¦</p>
</div>
<ul>
  <v-click>
    <li class="mb-6"><strong class="text-xl">é »ç¹ã«å‘¼ã°ã‚Œã‚‹ç®‡æ‰€(ãƒ›ãƒƒãƒˆã‚¹ãƒãƒƒãƒˆ)ã®é«˜é€ŸåŒ–</strong>
      <ul>
        <li>ãƒ¡ã‚½ãƒƒãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ã‚ˆã‚Šã€é »ç¹ã«å‘¼ã°ã‚Œã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã®çµæœã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã§ãã‚‹</li>
        <li>JIT ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ãƒ›ãƒƒãƒˆã‚¹ãƒãƒƒãƒˆã‚’ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›ã—é«˜é€ŸåŒ–ã§ãã‚‹</li>
      </ul>
    </li>
  </v-click>
  <v-click>
    <li class="mb-6"><strong class="text-xl">ãƒ¡ãƒ¢ãƒªé…ç½®ã«ã‚ˆã‚‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„</strong>
      <ul>
        <li>å‘½ä»¤åˆ—ãŒãƒ¡ãƒ¢ãƒªä¸Šã§ <strong>ç›´ç·šçš„ã«é…ç½®</strong> ã•ã‚Œã‚‹ãŸã‚ã€L1 / L2 ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ãƒ’ãƒƒãƒˆã—ã‚„ã™ã„ (cf. Tree-Walkingã ã¨random access)</li>
        <li>ãƒ¬ã‚¸ã‚¹ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ã‚ˆã‚Šã‚‚ãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹ã®æ–¹ãŒæ•°åå€ ~ æ•°ç™¾å€é…ã„ã®ã§ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«å½“ã¦ã‚„ã™ãã™ã‚‹ã ã‘ã§é€Ÿããªã‚‹</li>
      </ul>
    </li>
  </v-click>
  <v-click>
    <li class="mb-6"><strong class="text-xl">åˆ†å²äºˆæ¸¬ã«å½“ãŸã‚Šã‚„ã™ã„</strong>
      <ul>
        <li><strong>ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¹ãƒ¬ãƒƒãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰ï¼ˆDirect Threaded Codeï¼‰</strong> ãªã©ã®æ‰‹æ³•ã‚’é©ç”¨ã—ã‚„ã™ã„</li>
        <li>åˆ†å²ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒå˜ç´”ãªãŸã‚(å‘½ä»¤ã«ç›´æ¥ã‚¸ãƒ£ãƒ³ãƒ—)ã€CPU ã® <strong>åˆ†å²äºˆæ¸¬ãŒé«˜ç²¾åº¦</strong> ã§å½“ãŸã‚‹</li>
      </ul>
    </li>
  </v-click>
</ul>


---
layout: center
---

### ã•ã¦ã€å®Ÿã¯ã¾ã ç¶šããŒã‚ã‚‹ã®ã§ã™ãŒã€<br>åˆå¾Œã«ç¶šãã‚’å–ã£ã¦ãŠã„ã¦ã€


---
layout: center
---

### ã“ã“ã‹ã‚‰ã¯å®Ÿéš›ã«Rubyã§éŠã‚“ã§ã¿ã¾ã—ã‚‡ã†


---
layout: center
---

### ãŠé¡Œ: Rubyã‚’Localã§ãƒ“ãƒ«ãƒ‰ã—ã¦ã¿ã‚‹

---
layout: center
---

``` sh
# setup
mkdir rubykaigi-bootcamp && cd rubykaigi-bootcamp
git clone <ruby repo>
cd ruby

# configure fileã®ç”Ÿæˆ
./autogen.sh

# makefileã‚’ä½œã‚‹
cd ..
mkdir build && cd build
../ruby/configure --prefix=$PWD/../install --enable-shared

# makeã§build
make -j

# ã†ã¾ãã„ã‘ã°miniruby(æ©Ÿèƒ½åˆ¶é™ã¤ãã¨ã¯ã„ã£ã¦ã‚‚ã»ã¨ã‚“ã©ã®ã“ã¨ãŒã§ãã‚‹Ruby)ãŒbuildä»¥ä¸‹ã«ã§ãã¦ã„ã‚‹ã¯ãš
./miniruby -v

# install(ãƒ•ãƒ«ã‚»ãƒƒãƒˆRubyã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«)
make install
../install/bin/ruby -v
```


---
layout: center
---

### ãŠé¡Œ: ãƒ“ãƒ«ãƒ‰ã—ãŸRubyã§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œã—ã¦ã¿ã‚‹


---
layout: center
---
``` sh
cd ../ruby
touch test.rb && echo "puts 1 + 2" >> test.rb
make run # minirubyã§test.rbã‚’å®Ÿè¡Œã§ãã‚‹

make runruby # ãƒ•ãƒ«ã‚»ãƒƒãƒˆã®Rubyã§å®Ÿè¡Œã™ã‚‹
```

---
layout: center
---

### ãŠé¡Œ: minirubyã§debugã—ã¦ã¿ã‚‹


---
layout: center
---
``` sh
cd ../ruby
touch test.rb && echo "puts 1 + 2" >> test.rb
make run # minirubyã§test.rbã‚’å®Ÿè¡Œã§ãã‚‹
```


---
layout: center
---

### ãŠé¡Œ: Rubyã®versionè¡¨è¨˜ã‚’ã„ã˜ã£ã¦ã¿ã‚‹


---
layout: center
---

### ãŠé¡Œ: Array#secondã‚’è¶³ã—ã¦ã¿ã‚‹

